<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>LWDW!</title><meta name="description" content="Sign in with apple by Flutter in iOS"/><meta property="og:title" content="Sign in with apple by Flutter in iOS"/><meta property="og:description" content="Sign in with Apple is commonly used by modern apps now, this article will introduce a way to impleme......"/><meta name="next-head-count" content="6"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ffffff"/><meta name="color-scheme" content="dark light"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="theme-color" content="#000"/><meta property="og:type" content="website"/><meta property="og:image" content="https://s2.loli.net/2023/01/18/42YTZxzePtR7jy9.png"/><meta property="og:url" content="https://b-sirius.github.io"/><link rel="preload" href="/_next/static/css/aef510c8abf24c2c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aef510c8abf24c2c.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b51a0fb142b75fa0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b51a0fb142b75fa0.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-165611dbf69200d4.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-673a4fae4a27af6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0da236044dc4e5fc.js" defer=""></script><script src="/_next/static/chunks/332-751efa0ececa7b8e.js" defer=""></script><script src="/_next/static/chunks/664-1b4479b4462ded63.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-2b4aeb585f50200f.js" defer=""></script><script src="/_next/static/DHSDf10hmJmuXZS4WGULG/_buildManifest.js" defer=""></script><script src="/_next/static/DHSDf10hmJmuXZS4WGULG/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="sc-9d615c10-0 gPcDhw"><div class="sc-868660b6-0 hptnUW"><div class="sc-bbc62a17-1 bGsVUC"><div class="sc-bbc62a17-0 dSoHmK"><a class="sc-bbc62a17-2 gGxkic" href="/">[<!-- -->Home<!-- -->]</a><a class="sc-bbc62a17-2 gGxkic" href="/posts">[<!-- -->Posts<!-- -->]</a><a class="sc-bbc62a17-3 bMRVsR" rel="noopener noreferrer" target="_blank" href="https://github.com/B-sirius">[<!-- -->Github<!-- -->]</a><a class="sc-bbc62a17-3 bMRVsR" rel="noopener noreferrer" target="_blank" href="https://b-sirius.github.io/rss.xml">[<!-- -->RSS<!-- -->]</a></div><div class="sc-f71203c5-0 cEuFcK"><h1 class="sc-f71203c5-1 BdBtZ">LWDW!</h1><p class="sc-f71203c5-2 gXENPI">Learn the work from doing the worküç∫</p></div></div><div class="sc-87e76b53-0 sc-77cf2bd4-0 hkJmkj dxfnCq"><div><div class="sc-ba46d312-0 hOKWax"><div class="sc-ba46d312-2 ibvPNw">Sign in with apple by Flutter in iOS</div><div class="sc-ba46d312-3 hcdRzS">Posted on <!-- -->2023-03-02</div></div></div></div><div class="sc-87e76b53-0 hkJmkj"><div><div class="sc-ba46d312-1 dmDrcr"><div class="sc-e9ca5221-0 czeavQ"><p>Sign in with Apple is commonly used by modern apps now, this article will introduce a way to implement it with Flutter for iOS apps.</p>
<h2 id="intro">Intro</h2>
<p>Here I will introduce the Apple login flow in iOS, which is <strong>based on the authorization code.</strong></p>
<p>There should be another way to use the identity token and Apple public key to do the same job, but we didn‚Äôt put it into practice, so for now I won‚Äôt cover it.</p>
<h3 id="flow">Flow</h3>
<p>The iOS apple login flow is not bounded with flutter tech (Apple login in Android or Web has more steps than this and is not introduced here).</p>
<p><img src="https://s2.loli.net/2023/03/02/IhVbdx2l3JFeP56.png" alt="apple login in iOS"/></p>
<h3 id="used-packages">Used Packages</h3>
<ul>
<li>Flutter<!-- -->
<ul>
<li><a href="https://pub.dev/packages/sign_in_with_apple" target="_blank" rel="noreferrer">sign_in_with_apple</a>. Flutter bridge to Sign in with Apple.</li>
</ul>
</li>
<li>Node<!-- -->
<ul>
<li><a href="https://www.npmjs.com/package/apple-signin-auth" target="_blank" rel="noreferrer">apple-signin-auth</a>. Apple sign in for Node.js.</li>
</ul>
</li>
</ul>
<h3 id="docs">Docs</h3>
<ul>
<li><a href="https://developer.apple.com/documentation/sign_in_with_apple/generate_and_validate_tokens" target="_blank" rel="noreferrer">Apple Developer Documentation</a></li>
</ul>
<h2 id="steps">Steps</h2>
<h3 id="1-settings-on-the-apple-developer-page">1. Settings on the Apple Developer page</h3>
<p><strong>A paid apple developer membership account is required for this step!</strong></p>
<p>In this step, we need to setup two things:</p>
<ul>
<li>an identifier that configures the App capabilities.</li>
<li>create a private key.</li>
</ul>
<h4 id="editcreate-identifier">edit/create Identifier</h4>
<p>Visit <a href="https://developer.apple.com/account/resources/certificates/list" target="_blank" rel="noreferrer">Certificates, Identifiers &amp; Profiles</a>. Choose ‚Äú<a href="https://developer.apple.com/account/resources/identifiers/list" target="_blank" rel="noreferrer">Identifiers</a>‚Äú and create/edit the APP‚Äôs identifier. Make sure ‚ÄúSign in with Apple‚Äú is selected in Capabilities.</p>
<p><img src="https://s2.loli.net/2023/03/02/KQPRUTC1rdqVnyu.jpg" alt="sign in with apple"/></p>
<p>After the identifier is created, it will show <strong>team ID</strong> and <strong>bundle ID</strong>.</p>
<p>we can also find team ID on <a href="https://developer.apple.com/account" target="_blank" rel="noreferrer">account page</a>.</p>
<h4 id="create-private-key">create private key</h4>
<p>Choose ‚Äú<a href="https://developer.apple.com/account/resources/authkeys/list" target="_blank" rel="noreferrer">keys</a>‚Äú and register a new key, also make sure ‚ÄúSign in with Apple‚Äú is selected.</p>
<p><img src="https://s2.loli.net/2023/03/02/HdgeWFJ5iU18lPQ.jpg" alt=""/></p>
<p>Then select the Primary app ID as the identifier bundle ID we just edited/selected.</p>
<p><img src="https://s2.loli.net/2023/03/02/14Mr82uSjNiplna.jpg" alt=""/></p>
<p>After it‚Äôs registered, it will provide a <strong>one-time</strong> download link to download the <strong>private key</strong> file.</p>
<p>Also, it has a <strong>key ID</strong>.</p>
<p><img src="https://s2.loli.net/2023/03/02/J1hN4YLM38aIUog.jpg" alt=""/></p>
<h3 id="2-settings-in-xcode">2. Settings in Xcode</h3>
<p>Open App project, Select ‚ÄúTarget-Runner-Signing &amp; Capabilities‚Äú and add ‚ÄúSign in with Apple‚Äú Capability.</p>
<p><img src="https://s2.loli.net/2023/03/02/zn9LjGBDYqpmJSk.jpg" alt=""/></p>
<p>Open ‚ÄúSigning‚Äú tab and select the developer team ID and bundle ID.</p>
<p><img src="https://s2.loli.net/2023/03/02/s4G7wMlEqYRf8Xk.jpg" alt=""/></p>
<h3 id="3-logic-in-the-client-side">3. Logic in the Client side</h3>
<p>We are using flutter to build our App, and the package <a href="https://pub.dev/packages/sign_in_with_apple" target="_blank" rel="noreferrer">sign_in_with_apple</a> will help integrate with Apple service to get the credential we need. It‚Äôs usage is very straightforward so just check the <a href="https://pub.dev/packages/sign_in_with_apple#example-usage" target="_blank" rel="noreferrer">example</a>. And in the end, you will get a credential that contains the authorization code. It will be the key parameter for our App login API.</p>
<h3 id="4-logic-in-the-app-service-side">4. Logic in the App Service side</h3>
<p>The APP service will handle most part of the work. We are using node.js and the package <a href="https://www.npmjs.com/package/apple-signin-auth" target="_blank" rel="noreferrer">apple-signin-auth</a>.</p>
<p>In this step, we only focus on two parts:</p>
<ul>
<li>create client secret</li>
<li>get authorization token</li>
</ul>
<h4 id="create-client-secret">create client secret</h4>
<p>Before we can ask Apple service for an authorization token, we need a ‚Äúclient secret‚Äú, which is a JWT used for each validation request between our server and apple service. if we check the <a href="https://developer.apple.com/documentation/sign_in_with_apple/generate_and_validate_tokens#3262048" target="_blank" rel="noreferrer">doc</a> for details, we will see Apple requests the JWT be signed with a specific algorithm. So the <a href="https://www.npmjs.com/package/apple-signin-auth" target="_blank" rel="noreferrer">apple-signin-auth</a> do us a favor, just use appleSignin.getClientSecret with the right parameters:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> clientSecret <span class="token operator">=</span> appleSignin<span class="token punctuation">.</span><span class="token method function property-access">getClientSecret</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">clientID</span><span class="token operator">:</span> <span class="token string">&#x27;com.company.app&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// Apple Client ID, AKA Bundle ID</span>
  <span class="token literal-property property">teamID</span><span class="token operator">:</span> <span class="token string">&#x27;teamID&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// Apple Developer Team ID.</span>
  <span class="token literal-property property">privateKey</span><span class="token operator">:</span> <span class="token string">&#x27;PRIVATE_KEY_STRING&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// private key associated with your client ID. -- Or provide a `privateKeyPath` property instead.</span>
  <span class="token literal-property property">keyIdentifier</span><span class="token operator">:</span> <span class="token string">&#x27;XXXXXXXXXX&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// identifier of the private key. AKA key ID. - can be found here https://developer.apple.com/account/resources/authkeys/list</span>
  <span class="token comment">// OPTIONAL</span>
  <span class="token literal-property property">expAfter</span><span class="token operator">:</span> <span class="token number">15777000</span><span class="token punctuation">,</span> <span class="token comment">// Duration after which to expire JWT</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="get-authorization-token">get authorization token</h3>
<p>This part is straightforward. Just call the API and Apple service will return the authorization token. We can check the <a href="https://developer.apple.com/documentation/sign_in_with_apple/generate_and_validate_tokens#url" target="_blank" rel="noreferrer">doc</a> and as always, <a href="https://www.npmjs.com/package/apple-signin-auth" target="_blank" rel="noreferrer">apple-signin-auth</a> wrapped it as a function to call:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">clientID</span><span class="token operator">:</span> <span class="token string">&#x27;com.company.app&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// Apple Client ID, AKA Bundle ID</span>
  <span class="token literal-property property">redirectUri</span><span class="token operator">:</span> <span class="token string">&#x27;http://localhost:3000/auth/apple/callback&#x27;</span><span class="token punctuation">,</span> <span class="token comment">// We don&#x27;t need it in our login flow.</span>
  <span class="token literal-property property">clientSecret</span><span class="token operator">:</span> clientSecret
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tokenResponse <span class="token operator">=</span> <span class="token keyword control-flow">await</span> appleSignin<span class="token punctuation">.</span><span class="token method function property-access">getAuthorizationToken</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Once our App Service gets the authorization token, we can do our business logic, like getting the user info, which shouldn‚Äôt be a problem.</p>
<h2 id="conclusion">Conclusion</h2>
<p>So this is the way to support Apple login <strong>based on the authorization code in</strong> <strong>iOS</strong>. Just remember there are other ways and more to set up if you want to support Android or Web.</p></div></div></div></div><div class="sc-3304c032-0 fiBoCN"><div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"apple-login-with-flutter-in-ios","title":"Sign in with apple by Flutter in iOS","date":"2023-03-02","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h2: \"h2\",\n    strong: \"strong\",\n    h3: \"h3\",\n    img: \"img\",\n    ul: \"ul\",\n    li: \"li\",\n    a: \"a\",\n    h4: \"h4\",\n    pre: \"pre\",\n    code: \"code\",\n    span: \"span\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"Sign in with Apple is commonly used by modern apps now, this article will introduce a way to implement it with Flutter for iOS apps.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"intro\",\n      children: \"Intro\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Here I will introduce the Apple login flow in iOS, which is \", _jsx(_components.strong, {\n        children: \"based on the authorization code.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"There should be another way to use the identity token and Apple public key to do the same job, but we didn‚Äôt put it into practice, so for now I won‚Äôt cover it.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"flow\",\n      children: \"Flow\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The iOS apple login flow is not bounded with flutter tech (Apple login in Android or Web has more steps than this and is not introduced here).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/IhVbdx2l3JFeP56.png\",\n        alt: \"apple login in iOS\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"used-packages\",\n      children: \"Used Packages\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"Flutter\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [_jsx(_components.a, {\n              href: \"https://pub.dev/packages/sign_in_with_apple\",\n              children: \"sign_in_with_apple\"\n            }), \". Flutter bridge to Sign in with Apple.\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Node\", \"\\n\", _jsxs(_components.ul, {\n          children: [\"\\n\", _jsxs(_components.li, {\n            children: [_jsx(_components.a, {\n              href: \"https://www.npmjs.com/package/apple-signin-auth\",\n              children: \"apple-signin-auth\"\n            }), \". Apple sign in for Node.js.\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"docs\",\n      children: \"Docs\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"https://developer.apple.com/documentation/sign_in_with_apple/generate_and_validate_tokens\",\n          children: \"Apple Developer Documentation\"\n        })\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"steps\",\n      children: \"Steps\"\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"1-settings-on-the-apple-developer-page\",\n      children: \"1. Settings on the Apple Developer page\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.strong, {\n        children: \"A paid apple developer membership account is required for this step!\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this step, we need to setup two things:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"an identifier that configures the App capabilities.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"create a private key.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"editcreate-identifier\",\n      children: \"edit/create Identifier\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Visit \", _jsx(_components.a, {\n        href: \"https://developer.apple.com/account/resources/certificates/list\",\n        children: \"Certificates, Identifiers \u0026 Profiles\"\n      }), \". Choose ‚Äú\", _jsx(_components.a, {\n        href: \"https://developer.apple.com/account/resources/identifiers/list\",\n        children: \"Identifiers\"\n      }), \"‚Äú and create/edit the APP‚Äôs identifier. Make sure ‚ÄúSign in with Apple‚Äú is selected in Capabilities.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/KQPRUTC1rdqVnyu.jpg\",\n        alt: \"sign in with apple\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"After the identifier is created, it will show \", _jsx(_components.strong, {\n        children: \"team ID\"\n      }), \" and \", _jsx(_components.strong, {\n        children: \"bundle ID\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"we can also find team ID on \", _jsx(_components.a, {\n        href: \"https://developer.apple.com/account\",\n        children: \"account page\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"create-private-key\",\n      children: \"create private key\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Choose ‚Äú\", _jsx(_components.a, {\n        href: \"https://developer.apple.com/account/resources/authkeys/list\",\n        children: \"keys\"\n      }), \"‚Äú and register a new key, also make sure ‚ÄúSign in with Apple‚Äú is selected.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/HdgeWFJ5iU18lPQ.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Then select the Primary app ID as the identifier bundle ID we just edited/selected.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/14Mr82uSjNiplna.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"After it‚Äôs registered, it will provide a \", _jsx(_components.strong, {\n        children: \"one-time\"\n      }), \" download link to download the \", _jsx(_components.strong, {\n        children: \"private key\"\n      }), \" file.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Also, it has a \", _jsx(_components.strong, {\n        children: \"key ID\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/J1hN4YLM38aIUog.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"2-settings-in-xcode\",\n      children: \"2. Settings in Xcode\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Open App project, Select ‚ÄúTarget-Runner-Signing \u0026 Capabilities‚Äú and add ‚ÄúSign in with Apple‚Äú Capability.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/zn9LjGBDYqpmJSk.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Open ‚ÄúSigning‚Äú tab and select the developer team ID and bundle ID.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"https://s2.loli.net/2023/03/02/s4G7wMlEqYRf8Xk.jpg\",\n        alt: \"\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"3-logic-in-the-client-side\",\n      children: \"3. Logic in the Client side\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We are using flutter to build our App, and the package \", _jsx(_components.a, {\n        href: \"https://pub.dev/packages/sign_in_with_apple\",\n        children: \"sign_in_with_apple\"\n      }), \" will help integrate with Apple service to get the credential we need. It‚Äôs usage is very straightforward so just check the \", _jsx(_components.a, {\n        href: \"https://pub.dev/packages/sign_in_with_apple#example-usage\",\n        children: \"example\"\n      }), \". And in the end, you will get a credential that contains the authorization code. It will be the key parameter for our App login API.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"4-logic-in-the-app-service-side\",\n      children: \"4. Logic in the App Service side\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The APP service will handle most part of the work. We are using node.js and the package \", _jsx(_components.a, {\n        href: \"https://www.npmjs.com/package/apple-signin-auth\",\n        children: \"apple-signin-auth\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this step, we only focus on two parts:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"create client secret\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"get authorization token\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h4, {\n      id: \"create-client-secret\",\n      children: \"create client secret\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Before we can ask Apple service for an authorization token, we need a ‚Äúclient secret‚Äú, which is a JWT used for each validation request between our server and apple service. if we check the \", _jsx(_components.a, {\n        href: \"https://developer.apple.com/documentation/sign_in_with_apple/generate_and_validate_tokens#3262048\",\n        children: \"doc\"\n      }), \" for details, we will see Apple requests the JWT be signed with a specific algorithm. So the \", _jsx(_components.a, {\n        href: \"https://www.npmjs.com/package/apple-signin-auth\",\n        children: \"apple-signin-auth\"\n      }), \" do us a favor, just use appleSignin.getClientSecret with the right parameters:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-javascript\",\n      children: _jsxs(_components.code, {\n        className: \"language-javascript\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" clientSecret \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" appleSignin\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"getClientSecret\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"clientID\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'com.company.app'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// Apple Client ID, AKA Bundle ID\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"teamID\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'teamID'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// Apple Developer Team ID.\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"privateKey\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'PRIVATE_KEY_STRING'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// private key associated with your client ID. -- Or provide a `privateKeyPath` property instead.\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"keyIdentifier\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'XXXXXXXXXX'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// identifier of the private key. AKA key ID. - can be found here https://developer.apple.com/account/resources/authkeys/list\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// OPTIONAL\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"expAfter\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token number\",\n          children: \"15777000\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// Duration after which to expire JWT\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      id: \"get-authorization-token\",\n      children: \"get authorization token\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This part is straightforward. Just call the API and Apple service will return the authorization token. We can check the \", _jsx(_components.a, {\n        href: \"https://developer.apple.com/documentation/sign_in_with_apple/generate_and_validate_tokens#url\",\n        children: \"doc\"\n      }), \" and as always, \", _jsx(_components.a, {\n        href: \"https://www.npmjs.com/package/apple-signin-auth\",\n        children: \"apple-signin-auth\"\n      }), \" wrapped it as a function to call:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-javascript\",\n      children: _jsxs(_components.code, {\n        className: \"language-javascript\",\n        children: [_jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" options \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"clientID\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'com.company.app'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// Apple Client ID, AKA Bundle ID\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"redirectUri\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token string\",\n          children: \"'http://localhost:3000/auth/apple/callback'\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token comment\",\n          children: \"// We don't need it in our login flow.\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token literal-property property\",\n          children: \"clientSecret\"\n        }), _jsx(_components.span, {\n          className: \"token operator\",\n          children: \":\"\n        }), \" clientSecret\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\\n\", _jsx(_components.span, {\n          className: \"token keyword control-flow\",\n          children: \"try\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token keyword\",\n          children: \"const\"\n        }), \" tokenResponse \", _jsx(_components.span, {\n          className: \"token operator\",\n          children: \"=\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword control-flow\",\n          children: \"await\"\n        }), \" appleSignin\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"getAuthorizationToken\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"code\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \",\"\n        }), \" options\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token keyword control-flow\",\n          children: \"catch\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"err\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), \" \", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"{\"\n        }), \"\\n  \", _jsx(_components.span, {\n          className: \"token console class-name\",\n          children: \"console\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \".\"\n        }), _jsx(_components.span, {\n          className: \"token method function property-access\",\n          children: \"error\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"(\"\n        }), \"err\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \")\"\n        }), _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \";\"\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"token punctuation\",\n          children: \"}\"\n        }), \"\\n\"]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Once our App Service gets the authorization token, we can do our business logic, like getting the user info, which shouldn‚Äôt be a problem.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      id: \"conclusion\",\n      children: \"Conclusion\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"So this is the way to support Apple login \", _jsx(_components.strong, {\n        children: \"based on the authorization code in\"\n      }), \" \", _jsx(_components.strong, {\n        children: \"iOS\"\n      }), \". Just remember there are other ways and more to set up if you want to support Android or Web.\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"description":"Sign in with Apple is commonly used by modern apps now, this article will introduce a way to impleme......","usedCustomComponentNames":[]},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"apple-login-with-flutter-in-ios"},"buildId":"DHSDf10hmJmuXZS4WGULG","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>