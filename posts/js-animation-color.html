<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>LWDW!</title><meta name="description" content="å½“æˆ‘ä»¬è®¨è®ºåŠ¨ç”»æ—¶ï¼Œæˆ‘ä»¬åœ¨è®¨è®ºä»€ä¹ˆâ€”â€”â€”colorç¯‡"/><meta property="og:title" content="å½“æˆ‘ä»¬è®¨è®ºåŠ¨ç”»æ—¶ï¼Œæˆ‘ä»¬åœ¨è®¨è®ºä»€ä¹ˆâ€”â€”â€”colorç¯‡"/><meta property="og:description" content="é™¤äº†ä¸Šç¯‡çš„transformåŠ¨ç”»éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè¿˜æœ‰ä¸€ä¸ªå¤§å¤´å°±æ˜¯å±æ€§å€¼ä¸ºé¢œè‰²çš„å¤„ç†ã€‚ä¸åŒäºtransformï¼Œå±æ€§å€¼ä¸ºé¢œè‰²çš„å±æ€§å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œè€Œé¢œè‰²å±æ€§å€¼åˆæœ‰rgbã€hslã€rgbaç”šè‡³åå…­è¿›åˆ¶ç­‰å¤šç§è¡¨......"/><meta name="next-head-count" content="6"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ffffff"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="theme-color" content="#000"/><meta property="og:type" content="website"/><meta property="og:image" content="https://s2.loli.net/2023/01/18/42YTZxzePtR7jy9.png"/><meta property="og:url" content="https://b-sirius.github.io"/><link rel="preload" href="/_next/static/css/aef510c8abf24c2c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aef510c8abf24c2c.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-f164db4954bac6ec.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-673a4fae4a27af6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0da236044dc4e5fc.js" defer=""></script><script src="/_next/static/chunks/664-1b4479b4462ded63.js" defer=""></script><script src="/_next/static/chunks/332-e879213584d084bf.js" defer=""></script><script src="/_next/static/chunks/740-8163689fd2f6810b.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-52d68f4345545d9e.js" defer=""></script><script src="/_next/static/ebQpUXIPak7dk5fUIaYsa/_buildManifest.js" defer=""></script><script src="/_next/static/ebQpUXIPak7dk5fUIaYsa/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="sc-b711fa3b-0 dxGMRG"><div class="sc-7fa12c98-0 iqAzDm"><div class="sc-357ac6e1-1 blSmbb"><div class="sc-357ac6e1-0 fqUBXX"><a class="sc-357ac6e1-2 gfNIvm" href="/">[<!-- -->Home<!-- -->]</a><a class="sc-357ac6e1-2 gfNIvm" href="/posts">[<!-- -->Posts<!-- -->]</a><a class="sc-357ac6e1-3 eNeEmH" rel="noopener noreferrer" target="_blank" href="https://github.com/B-sirius">[<!-- -->Github<!-- -->]</a><a class="sc-357ac6e1-3 eNeEmH" rel="noopener noreferrer" target="_blank" href="https://b-sirius.github.io/rss.xml">[<!-- -->RSS<!-- -->]</a></div><div class="sc-f5ce872-0 drvesR"><h1 class="sc-f5ce872-1 jPBPjm">LWDW!</h1><p class="sc-f5ce872-2 djaGsH">Learn the work from doing the workğŸº</p></div></div><div class="sc-920e94b6-0 sc-20291786-0 cMfBpD eCERES"><div><div class="sc-6a240bda-0 gspkRs"><div class="sc-6a240bda-2 bnlUwj">å½“æˆ‘ä»¬è®¨è®ºåŠ¨ç”»æ—¶ï¼Œæˆ‘ä»¬åœ¨è®¨è®ºä»€ä¹ˆâ€”â€”â€”colorç¯‡</div><div class="sc-6a240bda-3 hZSIRN">Posted on <!-- -->2017-04-30</div></div></div></div><div class="sc-920e94b6-0 cMfBpD"><div><div class="sc-6a240bda-1 bymzAy"><div class="sc-29ea8e37-0 bjoUyc"></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"js-animation-color","title":"å½“æˆ‘ä»¬è®¨è®ºåŠ¨ç”»æ—¶ï¼Œæˆ‘ä»¬åœ¨è®¨è®ºä»€ä¹ˆâ€”â€”â€”colorç¯‡","date":"2017-04-30","mdText":"\n## è®¾è®¡æ¨¡å¼çš„è¿ç”¨\n\né™¤äº†ä¸Šç¯‡çš„transformåŠ¨ç”»éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè¿˜æœ‰ä¸€ä¸ªå¤§å¤´å°±æ˜¯å±æ€§å€¼ä¸ºé¢œè‰²çš„å¤„ç†ã€‚ä¸åŒäºtransformï¼Œå±æ€§å€¼ä¸ºé¢œè‰²çš„å±æ€§å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œè€Œé¢œè‰²å±æ€§å€¼åˆæœ‰rgbã€hslã€rgbaç”šè‡³åå…­è¿›åˆ¶ç­‰å¤šç§è¡¨ç¤ºæ–¹å¼ï¼Œæ„å‘³ç€ä¸¤è€…å¯¹å±æ€§åã€å±æ€§å€¼åˆ†ç¦»çš„é€»è¾‘ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œå†åŠ ä¸Šå¯¹æ™®é€šå±æ€§å¤„ç†çš„é€»è¾‘ï¼Œè‡³å°‘æœ‰ä¸‰ç§ä¸åŒçš„åˆ†ç¦»é€»è¾‘ã€‚å› æ­¤åœ¨åŠ å…¥é¢œè‰²çš„å¤„ç†æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘å…ˆç”¨ç­–ç•¥æ¨¡å¼é‡æ„äº†è¿™éƒ¨åˆ†é€»è¾‘ï¼Œæœ€åç»“æœå¦‚ä¸‹ï¼š\n\n```javascript\n/**\n * å¯¹porpså±æ€§å€¼å¤„ç†ï¼Œè·å¾—æ¸²æŸ“æ—¶æ‰€éœ€çš„æ•°æ®\n */\nRush.prototype._handleProps = (function() {\n    // transform çš„å±æ€§éœ€è¦ç‰¹åˆ«å¤„ç†\n    const transformProperties = [\"translateX\", \"translateY\", \"translateZ\", \"scale\", \"scaleX\", \"scaleY\", \"scaleZ\", \"skewX\", \"skewY\", \"rotateX\", \"rotateY\", \"rotateZ\"];\n\n    // color çš„å±æ€§éœ€è¦ç‰¹åˆ«å¤„ç†\n    const colorProperties = [\"color\", \"background-color\", \"border-color\", \"outline-color\"];\n\n    var propertyHandler = {};\n\n    // æ™®é€šå±æ€§çš„å¤„ç†æ–¹æ³•\n    propertyHandler['default'] = function(task, key) {\n        var el = this.el;\n\n        var begin; // åˆå§‹å±æ€§å€¼å’Œå•ä½\n        var end = propertyValueHandler(key, task.props[key]); // æœ«å±æ€§æ•°å€¼å’Œå•ä½\n\n        var realPropertyName = key; // çœŸæ­£çš„å±æ€§å\n        var styleLogic = 'default';\n\n        var beginValue = getComputedStyle(el, null).getPropertyValue(realPropertyName); // è·å¾—åˆå§‹å±æ€§å€¼(å¸¦å•ä½)\n\n        begin = propertyValueHandler(key, beginValue); // è·å¾—å±æ€§æ•°å€¼å’Œå•ä½\n\n        realPropertyName = transferStyleName(realPropertyName); // å°†è¿å­—ç¬¦æ ¼å¼è½¬æ¢ä¸ºé©¼å³°å¼\n\n        // ä¸ºtaskæ–°å¢å±æ€§\n        task.newProps[key] = {\n            begin,\n            end,\n            realPropertyName,\n            styleLogic\n        }\n    }\n\n    // transformå±æ€§çš„å¤„ç†æ–¹æ³•\n    for (var propertyName of transformProperties) {\n        propertyHandler[propertyName] = function(task, key) {\n            var el = this.el;\n\n            var begin; // åˆå§‹å±æ€§å€¼å’Œå•ä½\n            var end = propertyValueHandler(key, task.props[key]); // æœ«å±æ€§æ•°å€¼å’Œå•ä½\n\n            var realPropertyName = 'transform';\n            var styleLogic = 'transform';\n\n            var beginValue; // åˆå§‹å±æ€§å€¼ï¼ˆå¸¦å•ä½ï¼‰\n\n            // å¦‚æœå·²ç»ç¼“å­˜äº†transformå±æ€§\n            if (el.transformCache) {\n                if (el.transformCache[key]) {\n                    beginValue = el.transformCache[key].value;\n                } else {\n                    beginValue = 0;\n                    el.transformCache[key] = {\n                        value: beginValue,\n                        unitType: end.unitType\n                    };\n                }\n            } else {\n                // åªæœ‰åœ¨å…ƒç´ æ²¡æœ‰åœ¨styleä¸­å®šä¹‰ä»»ä½•transformå±æ€§æ—¶æ‰ä¼šè°ƒç”¨\n                beginValue = 0;\n\n                // ç»™è¿™ä¸ªå…ƒç´ æ·»åŠ transfromCacheå±æ€§ï¼Œç”¨äºä¿å­˜transfromçš„å„ä¸ªå±æ€§\n                // å› ä¸ºå¦‚æœstyleä¸­çš„transformè¢«è®¾ç½®äº†å¤šä¸ªå€¼ï¼Œè¯»å–åˆ°çš„å°†æ˜¯\"rotate(30deg) translateX(10px)\"è¿™æ ·çš„å€¼ï¼Œå°†æ— æ³•å¤„ç†\n                el.transformCache = {};\n                el.transformCache[key] = {\n                    value: beginValue,\n                    unitType: end.unitType\n                };\n            }\n\n            begin = propertyValueHandler(key, beginValue); // è·å¾—å±æ€§æ•°å€¼å’Œå•ä½\n\n            // ä¸ºtaskæ–°å¢å±æ€§\n            task.newProps[key] = {\n                begin,\n                end,\n                realPropertyName,\n                styleLogic\n            }\n        }\n    }\n\n    // colorå±æ€§çš„å¤„ç†æ–¹æ³•ï¼Œç»Ÿä¸€è½¬æ¢ä¸ºrgbaæ¥å¤„ç†\n    for (var propertyName of colorProperties) {\n        propertyHandler[propertyName] = function(task, key) {\n            var el = this.el;\n\n            var begin;\n            var end = normalize2rgba(task.props[key]);\n\n            var realPropertyName = key;\n\n            var beginValue = getComputedStyle(el, null).getPropertyValue(realPropertyName); // e.g. rgba(255, 255, 255, 1);\n            begin = normalize2rgba(beginValue); // è¿”å›çš„æ˜¯è½¬æ¢åçš„rgbaå¯¹è±¡\n\n            var styleLogic = 'rgba';\n\n            realPropertyName = transferStyleName(realPropertyName); // å°†è¿å­—ç¬¦æ ¼å¼è½¬æ¢ä¸ºé©¼å³°å¼\n\n\n            task.newProps[key] = {\n                begin,\n                end,\n                realPropertyName,\n                styleLogic\n            }\n        }\n    }\n\n    return function(task) {\n        var el = this.el;\n\n        task.newProps = {}; // ä¿å­˜æ¸²æŸ“åŠ¨ç”»æ—¶æ‰€éœ€çš„æ•°æ®\n\n        for (var key in task.props) {\n            if (propertyHandler[key]) { // ç‰¹æ®Šå±æ€§\n                propertyHandler[key].call(this, task, key);\n            } else { // æ™®é€šå±æ€§\n                propertyHandler['default'].call(this, task, key);\n            }\n        }\n    }\n})();\n```\n\n## colorçš„ç—›ç‚¹\n\n- colorçš„å¤šç§å±æ€§å€¼\n\n  å±æ€§å€¼å¯èƒ½æ˜¯rgbè‰²ï¼Œhslè‰²ï¼Œrgbaè‰²ç”šè‡³16è¿›åˆ¶è‰²ï¼Œä¸ºä»–ä»¬å„åšä¸€ç§å¤„ç†é€»è¾‘æ˜¾ç„¶å¤ªè¿‡å¤æ‚ä¸”æ²¡æœ‰å¿…è¦ï¼Œå°†å…¶å…¨éƒ¨è½¬æ¢æˆåŒä¸€å•ä½å†è¿›è¡Œå¤„ç†æ›´åŠ æ˜æ™ºã€‚è€ƒè™‘åˆ°é€æ˜åº¦ï¼Œæˆ‘è§‰å¾—å…¨éƒ¨è½¬æ¢ä¸ºrgbaæœ€ä¸ºåˆé€‚ã€‚é¢œè‰²è½¬æ¢çš„é€»è¾‘åˆ°å¤„éƒ½èƒ½æ‰¾åˆ°å°±ä¸ç»†è¯´äº†ã€‚\n\n- rgbaå±æ€§å€¼çš„åˆ†ç¦»\n\n  ä¸åŒäºä¹‹å‰æ‰€æœ‰çš„å±æ€§å€¼ï¼Œrgbaå€¼æœ‰4ä¸ªæ•°å€¼ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬çš„ç¼“åŠ¨å‡½æ•°æ¯æ¬¡åªå¤„ç†ä¸€ä¸ªæ•°å€¼ï¼Œéœ€è¦ç”¨æ•°ç»„ä¿å­˜å†è¿›è¡Œåˆ†åˆ«å¤„ç†\n\n  ```javascript\n  for (var key in task.newProps) {\n              if (typeof task.newProps[key].begin.num !== 'number') {\n                  var beginArr = task.newProps[key].begin.num;\n                  var endArr = task.newProps[key].end.num;\n\n                  var newArr = [];\n                  for (var i = 0; i \u003c beginArr.length; i++) {\n                      var beginValue = beginArr[i],\n                          changeValue = endArr[i] - beginValue,\n                          newValue = easing(currTime, beginValue, changeValue, duration); // æ ¹æ®ç¼“åŠ¨å‡½æ•°è®¡ç®—æ–°çš„ä½ç½®\n                          newArr.push(newValue);\n                  };\n\n                  self.styleHandler(task, key, newArr);\n              } else {\n                  var beginValue = task.newProps[key].begin.num, // åˆå§‹ä½ç½®\n                      changeValue = task.newProps[key].end.num - beginValue; // ä½ç½®æ”¹å˜é‡\n\n                  var newValue = easing(currTime, beginValue, changeValue, duration); // æ ¹æ®ç¼“åŠ¨å‡½æ•°è®¡ç®—æ–°çš„ä½ç½®\n\n                  // æ›´æ–°style\n                  self.styleHandler(task, key, newValue);\n              }\n          }\n  ```\n\n- å°†å¤„ç†åå¾—åˆ°çš„æ–°å±æ€§é‡æ–°æ‹¼æ¥ä¸ºstyleæ ·å¼\n\n  åŒæ ·æ˜¯é‡‡å–ç­–ç•¥æ¨¡å¼ï¼Œä¸ºä¸åŒçš„æ‹¼æ¥é€»è¾‘å®šä¹‰äº†å¯¹åº”çš„æ‹¼æ¥æ–¹æ³•\n\n  ```javascript\n  Rush.prototype.styleHandler = (function() {\n      var t = {\n          'transform': function(task, key, newValue) {\n              this.el.transformCache[key].value = newValue; // æ›´æ–°ç¼“å­˜å€¼\n\n              var propertyValue = '',\n                  propertyName = task.newProps[key].realPropertyName;\n\n              // e.g transform: rotateZ(100deg) translateX(50px)\n              for (var key in this.el.transformCache) {\n                  var name = key, // e.g rotateZ\n                      val = this.el.transformCache[key].value, // e.g 100\n                      unitType = this.el.transformCache[key].unitType; // e.g deg\n\n                  propertyValue += `${name}(${val}${unitType})`; // e.g rotate(100deg)\n              }\n\n              this.el.style[propertyName] = propertyValue;\n          },\n\n          'rgba': function(task, key, newArr) {\n              var text = 'rgba(';\n\n              for (var i = 0; i \u003c newArr.length - 1; i++) {\n                  text += (newArr[i]).toFixed() + ', ';\n              }\n              text += newArr[newArr.length - 1].toFixed(2) + ')';\n\n              this.el.style[task.newProps[key].realPropertyName] = text;\n          },\n\n          'default': function(task, key, newValue) {\n              this.el.style[task.newProps[key].realPropertyName] = `${newValue}${task.newProps[key].end.unitType}`;\n          }\n      };\n\n      return function(task, key, newValue) {\n          var styleLogic = task.newProps[key].styleLogic;\n\n          t[styleLogic].call(this, task, key, newValue);\n      };\n  })();\n  ```\n\n------\n\nè‡³æ­¤ï¼Œé€šç”¨jsåŠ¨ç”»åº“çš„ä¸¤å¤§éš¾ç‚¹åŸºæœ¬å¾—åˆ°è§£å†³ï¼Œè™½è¯´æ˜¯é’ˆå¯¹transformå’Œcolorçš„å¤„ç†æ–¹æ³•ï¼Œä½†åœ¨ç¼–ç è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•è¿ç”¨è®¾è®¡æ¨¡å¼ä¼˜åŒ–ä»£ç ç»“æ„å¯èƒ½èŠ±è´¹äº†æ›´å¤šçš„æ—¶é—´ã€‚","description":"é™¤äº†ä¸Šç¯‡çš„transformåŠ¨ç”»éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè¿˜æœ‰ä¸€ä¸ªå¤§å¤´å°±æ˜¯å±æ€§å€¼ä¸ºé¢œè‰²çš„å¤„ç†ã€‚ä¸åŒäºtransformï¼Œå±æ€§å€¼ä¸ºé¢œè‰²çš„å±æ€§å¯ä»¥æœ‰å¾ˆå¤šç§ï¼Œè€Œé¢œè‰²å±æ€§å€¼åˆæœ‰rgbã€hslã€rgbaç”šè‡³åå…­è¿›åˆ¶ç­‰å¤šç§è¡¨......"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"js-animation-color"},"buildId":"ebQpUXIPak7dk5fUIaYsa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>