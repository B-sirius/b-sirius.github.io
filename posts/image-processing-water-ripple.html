<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>LWDW!</title><meta name="description" content="图像处理初见！——水波纹"/><meta property="og:title" content="图像处理初见！——水波纹"/><meta property="og:description" content="水波纹效果的实现方法其实相当多，今天俺想讨论的一种是利用算法（就是说依照某种规则将图像的像素乱搞一通，看起来就像波纹一样！）来进行处理的，不借助波纹图片等等，因此有很高的可定制性。......"/><meta name="next-head-count" content="6"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ffffff"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="theme-color" content="#000"/><meta property="og:type" content="website"/><meta property="og:image" content="https://s2.loli.net/2023/01/18/42YTZxzePtR7jy9.png"/><meta property="og:url" content="https://b-sirius.github.io"/><link rel="preload" href="/_next/static/css/aef510c8abf24c2c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aef510c8abf24c2c.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b51a0fb142b75fa0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b51a0fb142b75fa0.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-f164db4954bac6ec.js" defer=""></script><script src="/_next/static/chunks/framework-114634acb84f8baa.js" defer=""></script><script src="/_next/static/chunks/main-673a4fae4a27af6a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-0da236044dc4e5fc.js" defer=""></script><script src="/_next/static/chunks/664-1b4479b4462ded63.js" defer=""></script><script src="/_next/static/chunks/332-e879213584d084bf.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-f9bad91587257bf5.js" defer=""></script><script src="/_next/static/kvsSgvEK6JubKqogaIT-v/_buildManifest.js" defer=""></script><script src="/_next/static/kvsSgvEK6JubKqogaIT-v/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="sc-590e23a2-0 iUjvom"><div class="sc-7fa12c98-0 iqAzDm"><div class="sc-357ac6e1-1 blSmbb"><div class="sc-357ac6e1-0 fqUBXX"><a class="sc-357ac6e1-2 gfNIvm" href="/">[<!-- -->Home<!-- -->]</a><a class="sc-357ac6e1-2 gfNIvm" href="/posts">[<!-- -->Posts<!-- -->]</a><a class="sc-357ac6e1-3 eNeEmH" rel="noopener noreferrer" target="_blank" href="https://github.com/B-sirius">[<!-- -->Github<!-- -->]</a><a class="sc-357ac6e1-3 eNeEmH" rel="noopener noreferrer" target="_blank" href="https://b-sirius.github.io/rss.xml">[<!-- -->RSS<!-- -->]</a></div><div class="sc-f5ce872-0 drvesR"><h1 class="sc-f5ce872-1 jPBPjm">LWDW!</h1><p class="sc-f5ce872-2 djaGsH">Learn the work from doing the work🍺</p></div></div><div class="sc-920e94b6-0 sc-659069c1-0 cMfBpD jHWfVM"><div><div class="sc-32c5999b-0 iFBmZi"><div class="sc-32c5999b-2 fHkOeB">图像处理初见！——水波纹</div><div class="sc-32c5999b-3 deKveP">Posted on <!-- -->2018-06-12</div></div></div></div><div class="sc-920e94b6-0 cMfBpD"><div><div class="sc-32c5999b-1 fNXLto"><div class="sc-a2d97488-0 dmbacr"><div><html><head></head><body><p>水波纹效果的实现方法其实相当多，今天俺想讨论的一种是利用算法（就是说依照某种规则将图像的像素乱搞一通，看起来就像波纹一样！）来进行处理的，不借助波纹图片等等，因此有很高的可定制性。</p>
<p><strong>WARNING——本文中的demo未做足够优化，不建议使用手机查看</strong></p>
<h2 id="首先来看一眼效果">首先来看一眼效果</h2>
<p data-height="265" data-theme-id="0" data-slug-hash="YvVypN" data-default-tab="js,result" data-user="padfoot_07" data-embed-version="2" data-pen-title="water ripple" class="codepen">See the Pen <a href="https://codepen.io/padfoot_07/pen/YvVypN/" target="_blank" rel="nofollow">water ripple</a> by Zhouyi (<a href="https://codepen.io/padfoot_07" target="_blank" rel="nofollow">@padfoot_07</a>) on <a href="https://codepen.io" target="_blank" rel="nofollow">CodePen</a>.</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>
<p>【伤害大家的眼睛使我快乐】</p>
<h2 id="那么这么好的算法是什么呢">那么，这么好的算法是什么呢?</h2>
<h3 id="不准确的大概描述">不准确的大概描述</h3>
<p>在具体介绍策略之前，俺先模糊的描述一下这个策略的思想：</p>
<p>水波纹本质上是像素有规律的发生<strong>偏移（offset）<strong>造成的视觉效果，且这个偏移连续进行，看起来才会像是水波扩散、荡漾一样。因此在我们试图将这种偏移作用到图像（一堆像素）上之前，首先思考的是一连串的数值变化；我们为图像的每一个像素都赋予一个数值，来代表它在“水波纹”作用下的状态。而这个变化要具有连续性，我们要不停记录</strong>当前</strong>和<strong>上一帧渲染</strong>的状态，再依据某种策略使其状态的改变自发进行下去。之后再<strong>依据每个像素的状态信息，计算出它的偏移</strong>。</p>
<h3 id="具体策略">具体策略</h3>
<p>假设我们处理的是100*100的图像，这个策略大概分为这么几步：</p>
<ol>
<li>
<p>记录水波纹**当前（current）<strong>和</strong>上一帧渲染时（previous）**的状态信息。就像我们上文提的一样，这里的信息是对应每个像素的，因此俺就使用了两个数组来记录，长度都为10000（100*100，对应像素顺序是按照一行一行排列</p>
<p>，从左向右，从上向下），均初始化为0。</p>
</li>
<li>
<p>每一帧，都利用previous对current进行混合（这里似乎是一种<strong>卷积</strong>计算，然而俺的高数不好，可自行了解），并交换两者，具体如下：</p>
<ul>
<li>
<p>对于每个像素的current值（为了方便，边缘像素这里不处理），将其previous中的邻居像素（比如它的上下左右四个像素）的状态数值相加，除以2，减去current中的数值——当然我知道你听不懂，所以画了个图：</p>
<p><img src="https://hukua-blog.oss-cn-beijing.aliyuncs.com/markdown-imgs/%E6%B3%A2%E7%BA%B9%E7%AD%96%E7%95%A5.png" alt="策略"></p>
</li>
<li>
<p>等等！根据常识，波纹的扩散（塌陷）幅度会之间减小，因此我们还需要一个阻尼来减小current值，最简单的方法就是每帧都乘以一个小于1的值。</p>
</li>
<li>
<p>PS: 当然，咱肯定会想，这他喵是什么个原理？虽然我也不知道是哪位大神想出的算法（这个算法的使用相当广泛，以至于我参考的不同实现样例都不约而同得使用了该算法），但是至少咱可以可视化这个过程，康康到底发生了什么：</p>
<p data-height="265" data-theme-id="0" data-slug-hash="rKymEg" data-default-tab="js,result" data-user="padfoot_07" data-embed-version="2" data-pen-title="水波纹策略-可视化" class="codepen">See the Pen <a href="https://codepen.io/padfoot_07/pen/rKymEg/" target="_blank" rel="nofollow">水波纹策略-可视化</a> by Zhouyi (<a href="https://codepen.io/padfoot_07" target="_blank" rel="nofollow">@padfoot_07</a>) on <a href="https://codepen.io" target="_blank" rel="nofollow">CodePen</a>.</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>
<p>这里demo将每个像素的current值直接作为rgb值赋予了像素，数值越高的像素看起来越“亮”，可以直观的看出数值的变化就是波纹状。</p>
</li>
</ul>
</li>
<li>
<p>接下来我们可以准备处理图像了，首先自然是获得图像的像素信息，比如我使用的p5.js，提供<code>loadPixels()</code>这样的api便可如字面意义获得图像所有的像素信息，数据结构大概是这样：</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">[</span>
    <span class="token comment">// 如100*100的图片，像素数据的顺序按照一行一行排列，共100*100*4个元素</span>
    <span class="token comment">// 第一个像素的rgba</span>
    <span class="token number">123</span><span class="token punctuation">,</span> <span class="token comment">// r</span>
    <span class="token number">255</span><span class="token punctuation">,</span> <span class="token comment">// g</span>
    <span class="token number">23</span><span class="token punctuation">,</span> <span class="token comment">// b</span>
    <span class="token number">255</span><span class="token punctuation">,</span> <span class="token comment">// a</span>
    <span class="token comment">// 第二个像素的rgba</span>
    <span class="token number">23</span><span class="token punctuation">,</span>
    <span class="token number">55</span><span class="token punctuation">,</span>
    <span class="token number">213</span><span class="token punctuation">,</span>
    <span class="token number">255</span><span class="token punctuation">,</span>
    <span class="token comment">// ......</span>
<span class="token punctuation">]</span>
</code></pre>
<p>当然你也可以定义自己习惯的数据格式。</p>
</li>
<li>
<p>现在我们需要根据current值来决定图像像素的偏移量offset了。说实话，这一步俺们有很大的自主权，参数以及函数的选择可以带来不同的效果。简单的来说，current值越高意味着水波越高，“折射”越明显，偏移值越大。</p>
</li>
<li>
<p>在最后，我们需要互换current和previous数组，准备开始下一轮计算。</p>
</li>
<li>
<p>基本是到这一步就结束了——但显然我们还差一个关键步骤，就是触发波纹。上文在初始化current和previous时初始化是0，如果我们不去改变，偏移值自然也一直是0。想要在某个位置触发“水波纹”，只需改变该像素的previous值便可，随后每帧进行的计算会推动波纹的产生。除此之外，还可做一些水波在图像边缘碰撞的检测使效果更加真实。</p>
</li>
<li>
<p>大概的代码，具体可查看最上方的样例：</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token spread operator">...</span>
<span class="token comment">// 触发波纹</span>
<span class="token keyword">function</span> <span class="token function">tick</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    previous<span class="token punctuation">[</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">512</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token spread operator">...</span>
<span class="token comment">// 每一帧绘制</span>
<span class="token keyword">function</span> <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">drawImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">loadPixels</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 循环非边缘的对象</span>
    <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&#x3C;</span> <span class="token constant">COLS</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword control-flow">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&#x3C;</span> <span class="token constant">ROWS</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            current<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
                previous<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span>
                previous<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span>
                previous<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span>
                previous<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> current<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

            current<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*=</span> dampening<span class="token punctuation">;</span>

			<span class="token spread operator">...</span>

            <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">-</span> current<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token comment">// 获得偏移值</span>
            <span class="token keyword">let</span> xoffset <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> data <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> yoffset <span class="token operator">=</span> <span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">*</span> data <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// 边缘检查</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>xoffset <span class="token operator">>=</span> <span class="token constant">COLS</span><span class="token punctuation">)</span> xoffset <span class="token operator">=</span> <span class="token constant">COLS</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>xoffset <span class="token operator">&#x3C;</span> <span class="token number">0</span><span class="token punctuation">)</span> xoffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>yoffset <span class="token operator">>=</span> <span class="token constant">ROWS</span><span class="token punctuation">)</span> yoffset <span class="token operator">=</span> <span class="token constant">ROWS</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>yoffset <span class="token operator">&#x3C;</span> <span class="token number">0</span><span class="token punctuation">)</span> yoffset <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token comment">// 根据偏移值获得偏移下标</span>
            <span class="token keyword">const</span> index <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> j <span class="token operator">*</span> <span class="token constant">COLS</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> newIndex <span class="token operator">=</span> <span class="token punctuation">(</span>xoffset <span class="token operator">+</span> yoffset <span class="token operator">*</span> <span class="token constant">COLS</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

            pixels<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> imagePixelsCopy<span class="token punctuation">[</span>newIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
            pixels<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> imagePixelsCopy<span class="token punctuation">[</span>newIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            pixels<span class="token punctuation">[</span>index <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> imagePixelsCopy<span class="token punctuation">[</span>newIndex <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">updatePixels</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 交换current与previous</span>
    <span class="token keyword">let</span> temp <span class="token operator">=</span> previous<span class="token punctuation">;</span>
    previous <span class="token operator">=</span> current<span class="token punctuation">;</span>
    current <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
</li>
</ol>
<h2 id="历史考察">历史考察</h2>
<p>在写这篇水文查阅资料时，发现有几篇文章都指向了一个现在无法打开的地址，好在<a href="https://archive.org/" target="_blank" rel="nofollow">archive</a>存有快照，这是篇98年的博客，作者对于算法的原理及应用都有很好的介绍，很建议阅读，这里是<a href="https://web.archive.org/web/20160607052007/http://freespace.virgin.net/hugo.elias/graphics/x_water.htm" target="_blank" rel="nofollow">地址</a>。</p>
<hr>
<p>我什么都不想做，我只想玩赛博朋克2077.jpg</p>
</body></html></div></div></div></div></div><div class="sc-bbd5e802-0 cbkQsN"><div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"id":"image-processing-water-ripple","title":"图像处理初见！——水波纹","date":"2018-06-12","htmlText":"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cp\u003e水波纹效果的实现方法其实相当多，今天俺想讨论的一种是利用算法（就是说依照某种规则将图像的像素乱搞一通，看起来就像波纹一样！）来进行处理的，不借助波纹图片等等，因此有很高的可定制性。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWARNING——本文中的demo未做足够优化，不建议使用手机查看\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"首先来看一眼效果\"\u003e首先来看一眼效果\u003c/h2\u003e\n\u003cp data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"YvVypN\" data-default-tab=\"js,result\" data-user=\"padfoot_07\" data-embed-version=\"2\" data-pen-title=\"water ripple\" class=\"codepen\"\u003eSee the Pen \u003ca href=\"https://codepen.io/padfoot_07/pen/YvVypN/\" target=\"_blank\" rel=\"nofollow\"\u003ewater ripple\u003c/a\u003e by Zhouyi (\u003ca href=\"https://codepen.io/padfoot_07\" target=\"_blank\" rel=\"nofollow\"\u003e@padfoot_07\u003c/a\u003e) on \u003ca href=\"https://codepen.io\" target=\"_blank\" rel=\"nofollow\"\u003eCodePen\u003c/a\u003e.\u003c/p\u003e\n\u003cscript async src=\"https://static.codepen.io/assets/embed/ei.js\"\u003e\u003c/script\u003e\n\u003cp\u003e【伤害大家的眼睛使我快乐】\u003c/p\u003e\n\u003ch2 id=\"那么这么好的算法是什么呢\"\u003e那么，这么好的算法是什么呢?\u003c/h2\u003e\n\u003ch3 id=\"不准确的大概描述\"\u003e不准确的大概描述\u003c/h3\u003e\n\u003cp\u003e在具体介绍策略之前，俺先模糊的描述一下这个策略的思想：\u003c/p\u003e\n\u003cp\u003e水波纹本质上是像素有规律的发生\u003cstrong\u003e偏移（offset）\u003cstrong\u003e造成的视觉效果，且这个偏移连续进行，看起来才会像是水波扩散、荡漾一样。因此在我们试图将这种偏移作用到图像（一堆像素）上之前，首先思考的是一连串的数值变化；我们为图像的每一个像素都赋予一个数值，来代表它在“水波纹”作用下的状态。而这个变化要具有连续性，我们要不停记录\u003c/strong\u003e当前\u003c/strong\u003e和\u003cstrong\u003e上一帧渲染\u003c/strong\u003e的状态，再依据某种策略使其状态的改变自发进行下去。之后再\u003cstrong\u003e依据每个像素的状态信息，计算出它的偏移\u003c/strong\u003e。\u003c/p\u003e\n\u003ch3 id=\"具体策略\"\u003e具体策略\u003c/h3\u003e\n\u003cp\u003e假设我们处理的是100*100的图像，这个策略大概分为这么几步：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e记录水波纹**当前（current）\u003cstrong\u003e和\u003c/strong\u003e上一帧渲染时（previous）**的状态信息。就像我们上文提的一样，这里的信息是对应每个像素的，因此俺就使用了两个数组来记录，长度都为10000（100*100，对应像素顺序是按照一行一行排列\u003c/p\u003e\n\u003cp\u003e，从左向右，从上向下），均初始化为0。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e每一帧，都利用previous对current进行混合（这里似乎是一种\u003cstrong\u003e卷积\u003c/strong\u003e计算，然而俺的高数不好，可自行了解），并交换两者，具体如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e对于每个像素的current值（为了方便，边缘像素这里不处理），将其previous中的邻居像素（比如它的上下左右四个像素）的状态数值相加，除以2，减去current中的数值——当然我知道你听不懂，所以画了个图：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://hukua-blog.oss-cn-beijing.aliyuncs.com/markdown-imgs/%E6%B3%A2%E7%BA%B9%E7%AD%96%E7%95%A5.png\" alt=\"策略\"\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e等等！根据常识，波纹的扩散（塌陷）幅度会之间减小，因此我们还需要一个阻尼来减小current值，最简单的方法就是每帧都乘以一个小于1的值。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003ePS: 当然，咱肯定会想，这他喵是什么个原理？虽然我也不知道是哪位大神想出的算法（这个算法的使用相当广泛，以至于我参考的不同实现样例都不约而同得使用了该算法），但是至少咱可以可视化这个过程，康康到底发生了什么：\u003c/p\u003e\n\u003cp data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"rKymEg\" data-default-tab=\"js,result\" data-user=\"padfoot_07\" data-embed-version=\"2\" data-pen-title=\"水波纹策略-可视化\" class=\"codepen\"\u003eSee the Pen \u003ca href=\"https://codepen.io/padfoot_07/pen/rKymEg/\" target=\"_blank\" rel=\"nofollow\"\u003e水波纹策略-可视化\u003c/a\u003e by Zhouyi (\u003ca href=\"https://codepen.io/padfoot_07\" target=\"_blank\" rel=\"nofollow\"\u003e@padfoot_07\u003c/a\u003e) on \u003ca href=\"https://codepen.io\" target=\"_blank\" rel=\"nofollow\"\u003eCodePen\u003c/a\u003e.\u003c/p\u003e\n\u003cscript async src=\"https://static.codepen.io/assets/embed/ei.js\"\u003e\u003c/script\u003e\n\u003cp\u003e这里demo将每个像素的current值直接作为rgb值赋予了像素，数值越高的像素看起来越“亮”，可以直观的看出数值的变化就是波纹状。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e接下来我们可以准备处理图像了，首先自然是获得图像的像素信息，比如我使用的p5.js，提供\u003ccode\u003eloadPixels()\u003c/code\u003e这样的api便可如字面意义获得图像所有的像素信息，数据结构大概是这样：\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 如100*100的图片，像素数据的顺序按照一行一行排列，共100*100*4个元素\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 第一个像素的rgba\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e123\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// r\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// g\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e23\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// b\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// a\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 第二个像素的rgba\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e23\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e55\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e213\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token number\"\u003e255\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// ......\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e当然你也可以定义自己习惯的数据格式。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e现在我们需要根据current值来决定图像像素的偏移量offset了。说实话，这一步俺们有很大的自主权，参数以及函数的选择可以带来不同的效果。简单的来说，current值越高意味着水波越高，“折射”越明显，偏移值越大。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e在最后，我们需要互换current和previous数组，准备开始下一轮计算。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e基本是到这一步就结束了——但显然我们还差一个关键步骤，就是触发波纹。上文在初始化current和previous时初始化是0，如果我们不去改变，偏移值自然也一直是0。想要在某个位置触发“水波纹”，只需改变该像素的previous值便可，随后每帧进行的计算会推动波纹的产生。除此之外，还可做一些水波在图像边缘碰撞的检测使效果更加真实。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e大概的代码，具体可查看最上方的样例：\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// 触发波纹\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003etick\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    previous\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token function\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003erandom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e400\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token function\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003erandom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e400\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e512\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// 每一帧绘制\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edraw\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003edrawImage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\t\u003cspan class=\"token function\"\u003eloadPixels\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e// 循环非边缘的对象\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token constant\"\u003eCOLS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e i\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword control-flow\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e j \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e j \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token constant\"\u003eROWS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e j\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            current\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n                previous\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\n                previous\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\n                previous\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\n                previous\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n            \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e current\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n            current\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*=\u003c/span\u003e dampening\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\t\t\t\u003cspan class=\"token spread operator\"\u003e...\u003c/span\u003e\n\n            \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e current\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"token comment\"\u003e// 获得偏移值\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e xoffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ei\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e yoffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ej\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e \u003cspan class=\"token number\"\u003e1024\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"token comment\"\u003e// 边缘检查\u003c/span\u003e\n            \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003exoffset \u003cspan class=\"token operator\"\u003e\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eCOLS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e xoffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eCOLS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003exoffset \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e xoffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eyoffset \u003cspan class=\"token operator\"\u003e\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eROWS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e yoffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eROWS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword control-flow\"\u003eelse\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eyoffset \u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e yoffset \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n            \u003cspan class=\"token comment\"\u003e// 根据偏移值获得偏移下标\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e index \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ei \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e j \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token constant\"\u003eCOLS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e newIndex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003exoffset \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e yoffset \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token constant\"\u003eCOLS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n            pixels\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eindex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e imagePixelsCopy\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003enewIndex\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            pixels\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eindex \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e imagePixelsCopy\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003enewIndex \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n            pixels\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eindex \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e imagePixelsCopy\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003enewIndex \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eupdatePixels\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e// 交换current与previous\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e temp \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e previous\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    previous \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e current\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    current \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e temp\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"历史考察\"\u003e历史考察\u003c/h2\u003e\n\u003cp\u003e在写这篇水文查阅资料时，发现有几篇文章都指向了一个现在无法打开的地址，好在\u003ca href=\"https://archive.org/\" target=\"_blank\" rel=\"nofollow\"\u003earchive\u003c/a\u003e存有快照，这是篇98年的博客，作者对于算法的原理及应用都有很好的介绍，很建议阅读，这里是\u003ca href=\"https://web.archive.org/web/20160607052007/http://freespace.virgin.net/hugo.elias/graphics/x_water.htm\" target=\"_blank\" rel=\"nofollow\"\u003e地址\u003c/a\u003e。\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e我什么都不想做，我只想玩赛博朋克2077.jpg\u003c/p\u003e\n\u003c/body\u003e\u003c/html\u003e","description":"水波纹效果的实现方法其实相当多，今天俺想讨论的一种是利用算法（就是说依照某种规则将图像的像素乱搞一通，看起来就像波纹一样！）来进行处理的，不借助波纹图片等等，因此有很高的可定制性。......"},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"image-processing-water-ripple"},"buildId":"kvsSgvEK6JubKqogaIT-v","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>